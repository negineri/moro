# URL リストからコンテンツをダウンロードする機能 実装方針

## 概要

- 指定されたテキストファイルから 1 行ずつ URL を読み込み、各 URL のコンテンツを順番にダウンロードする Python 機能を追加する。
- ダウンロードしたファイルは指定ディレクトリに保存する。

## 実装方針

### 1. 入力仕様

- 入力ファイル: 各行に 1 つの URL が記載されたテキストファイル（例: `urls.txt`）。
- 保存先ディレクトリ: コマンドライン引数または設定ファイルで指定。

### 2. 機能要件

- URL リストファイルを 1 行ずつ読み込む。
- 各 URL に対して HTTP リクエストを行い、コンテンツを取得。
- 取得したコンテンツをファイルとして保存。
  - ファイル名は URL やレスポンスヘッダから推定、または連番で命名。
- 失敗時はエラーログを出力し、処理を継続。
- 進捗やエラーは logging で記録。

### 3. 技術要件

- 標準ライブラリ（`httpx`のみ外部依存）を優先。
- 型ヒント・docstring を徹底。
- テスト容易性を考慮し、ダウンロード処理は関数分割。
- 例外処理・リトライ機構を実装。
- 設定値やパスは引数または`.env`/`settings.py`で管理。

### 4. 配置場所

- 実装: `src/moro/utils/` または `src/moro/services/` に新規モジュール作成。
- CLI 対応: 必要に応じて`src/moro/cli/`にエントリ追加。
- テスト: `tests/unit/`にテスト追加。
- ドキュメント: 本ファイルおよび`README.md`に概要追記。

### 5. テスト方針

- pytest でユニットテスト作成。
- モックを用いて外部通信をテスト。
- 異常系（無効 URL、タイムアウト等）もカバー。

---

## 今後のタスク

1. モジュール構成・関数設計
2. 実装（ダウンロード・保存処理）
3. CLI/設定対応
4. テスト作成
5. ドキュメント反映
